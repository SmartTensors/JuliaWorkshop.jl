\documentclass[11pt]{article}

    \usepackage[breakable]{tcolorbox}
    \usepackage{parskip} % Stop auto-indenting (to mimic markdown behaviour)
    
    \usepackage{iftex}
    \ifPDFTeX
    	\usepackage[T1]{fontenc}
    	\usepackage{mathpazo}
    \else
    	\usepackage{fontspec}
    \fi

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % Maintain compatibility with old templates. Remove in nbconvert 6.0
    \let\Oldincludegraphics\includegraphics
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionFormat{nocaption}{}
    \captionsetup{format=nocaption,aboveskip=0pt,belowskip=0pt}

    \usepackage{float}
    \floatplacement{figure}{H} % forces figures to be placed at the correct location
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range
    \makeatletter % fix for old versions of grffile with XeLaTeX
    \@ifpackagelater{grffile}{2019/11/01}
    {
      % Do nothing on new versions
    }
    {
      \def\Gread@@xetex#1{%
        \IfFileExists{"\Gin@base".bb}%
        {\Gread@eps{\Gin@base.bb}}%
        {\Gread@@xetex@aux#1}%
      }
    }
    \makeatother
    \usepackage[Export]{adjustbox} % Used to constrain images to a maximum size
    \adjustboxset{max size={0.9\linewidth}{0.9\paperheight}}

    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    % The default LaTeX title has an obnoxious amount of whitespace. By default,
    % titling removes some of it. It also provides customization options.
    \usepackage{titling}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    \usepackage{mathrsfs}
    

    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}
    \definecolor{ansi-default-inverse-fg}{HTML}{FFFFFF}
    \definecolor{ansi-default-inverse-bg}{HTML}{000000}

    % common color for the border for error outputs.
    \definecolor{outerrorbackground}{HTML}{FFDFDF}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatibility definitions
    \def\gt{>}
    \def\lt{<}
    \let\Oldtex\TeX
    \let\Oldlatex\LaTeX
    \renewcommand{\TeX}{\textrm{\Oldtex}}
    \renewcommand{\LaTeX}{\textrm{\Oldlatex}}
    % Document parameters
    % Document title
    \title{Parallelization}
    
    
    
    
    
% Pygments definitions
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\@namedef{PY@tok@w}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\@namedef{PY@tok@c}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cp}{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\@namedef{PY@tok@k}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kt}{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\@namedef{PY@tok@o}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ow}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@nb}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nf}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@nn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@ne}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\@namedef{PY@tok@nv}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@no}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\@namedef{PY@tok@nl}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\@namedef{PY@tok@ni}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\@namedef{PY@tok@na}{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\@namedef{PY@tok@nt}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@nd}{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\@namedef{PY@tok@s}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sd}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@si}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@se}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\@namedef{PY@tok@sr}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\@namedef{PY@tok@ss}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sx}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@m}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@gh}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@gu}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\@namedef{PY@tok@gd}{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\@namedef{PY@tok@gi}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\@namedef{PY@tok@gr}{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\@namedef{PY@tok@ge}{\let\PY@it=\textit}
\@namedef{PY@tok@gs}{\let\PY@bf=\textbf}
\@namedef{PY@tok@gp}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\@namedef{PY@tok@go}{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\@namedef{PY@tok@gt}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\@namedef{PY@tok@err}{\def\PY@bc##1{{\setlength{\fboxsep}{\string -\fboxrule}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}}
\@namedef{PY@tok@kc}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kd}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kn}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@kr}{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@bp}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\@namedef{PY@tok@fm}{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\@namedef{PY@tok@vc}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vg}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vi}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@vm}{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\@namedef{PY@tok@sa}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sb}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sc}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@dl}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s2}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@sh}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@s1}{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\@namedef{PY@tok@mb}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mf}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mh}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mi}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@il}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@mo}{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\@namedef{PY@tok@ch}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cm}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cpf}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@c1}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\@namedef{PY@tok@cs}{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % For linebreaks inside Verbatim environment from package fancyvrb. 
    \makeatletter
        \newbox\Wrappedcontinuationbox 
        \newbox\Wrappedvisiblespacebox 
        \newcommand*\Wrappedvisiblespace {\textcolor{red}{\textvisiblespace}} 
        \newcommand*\Wrappedcontinuationsymbol {\textcolor{red}{\llap{\tiny$\m@th\hookrightarrow$}}} 
        \newcommand*\Wrappedcontinuationindent {3ex } 
        \newcommand*\Wrappedafterbreak {\kern\Wrappedcontinuationindent\copy\Wrappedcontinuationbox} 
        % Take advantage of the already applied Pygments mark-up to insert 
        % potential linebreaks for TeX processing. 
        %        {, <, #, %, $, ' and ": go to next line. 
        %        _, }, ^, &, >, - and ~: stay at end of broken line. 
        % Use of \textquotesingle for straight quote. 
        \newcommand*\Wrappedbreaksatspecials {% 
            \def\PYGZus{\discretionary{\char`\_}{\Wrappedafterbreak}{\char`\_}}% 
            \def\PYGZob{\discretionary{}{\Wrappedafterbreak\char`\{}{\char`\{}}% 
            \def\PYGZcb{\discretionary{\char`\}}{\Wrappedafterbreak}{\char`\}}}% 
            \def\PYGZca{\discretionary{\char`\^}{\Wrappedafterbreak}{\char`\^}}% 
            \def\PYGZam{\discretionary{\char`\&}{\Wrappedafterbreak}{\char`\&}}% 
            \def\PYGZlt{\discretionary{}{\Wrappedafterbreak\char`\<}{\char`\<}}% 
            \def\PYGZgt{\discretionary{\char`\>}{\Wrappedafterbreak}{\char`\>}}% 
            \def\PYGZsh{\discretionary{}{\Wrappedafterbreak\char`\#}{\char`\#}}% 
            \def\PYGZpc{\discretionary{}{\Wrappedafterbreak\char`\%}{\char`\%}}% 
            \def\PYGZdl{\discretionary{}{\Wrappedafterbreak\char`\$}{\char`\$}}% 
            \def\PYGZhy{\discretionary{\char`\-}{\Wrappedafterbreak}{\char`\-}}% 
            \def\PYGZsq{\discretionary{}{\Wrappedafterbreak\textquotesingle}{\textquotesingle}}% 
            \def\PYGZdq{\discretionary{}{\Wrappedafterbreak\char`\"}{\char`\"}}% 
            \def\PYGZti{\discretionary{\char`\~}{\Wrappedafterbreak}{\char`\~}}% 
        } 
        % Some characters . , ; ? ! / are not pygmentized. 
        % This macro makes them "active" and they will insert potential linebreaks 
        \newcommand*\Wrappedbreaksatpunct {% 
            \lccode`\~`\.\lowercase{\def~}{\discretionary{\hbox{\char`\.}}{\Wrappedafterbreak}{\hbox{\char`\.}}}% 
            \lccode`\~`\,\lowercase{\def~}{\discretionary{\hbox{\char`\,}}{\Wrappedafterbreak}{\hbox{\char`\,}}}% 
            \lccode`\~`\;\lowercase{\def~}{\discretionary{\hbox{\char`\;}}{\Wrappedafterbreak}{\hbox{\char`\;}}}% 
            \lccode`\~`\:\lowercase{\def~}{\discretionary{\hbox{\char`\:}}{\Wrappedafterbreak}{\hbox{\char`\:}}}% 
            \lccode`\~`\?\lowercase{\def~}{\discretionary{\hbox{\char`\?}}{\Wrappedafterbreak}{\hbox{\char`\?}}}% 
            \lccode`\~`\!\lowercase{\def~}{\discretionary{\hbox{\char`\!}}{\Wrappedafterbreak}{\hbox{\char`\!}}}% 
            \lccode`\~`\/\lowercase{\def~}{\discretionary{\hbox{\char`\/}}{\Wrappedafterbreak}{\hbox{\char`\/}}}% 
            \catcode`\.\active
            \catcode`\,\active 
            \catcode`\;\active
            \catcode`\:\active
            \catcode`\?\active
            \catcode`\!\active
            \catcode`\/\active 
            \lccode`\~`\~ 	
        }
    \makeatother

    \let\OriginalVerbatim=\Verbatim
    \makeatletter
    \renewcommand{\Verbatim}[1][1]{%
        %\parskip\z@skip
        \sbox\Wrappedcontinuationbox {\Wrappedcontinuationsymbol}%
        \sbox\Wrappedvisiblespacebox {\FV@SetupFont\Wrappedvisiblespace}%
        \def\FancyVerbFormatLine ##1{\hsize\linewidth
            \vtop{\raggedright\hyphenpenalty\z@\exhyphenpenalty\z@
                \doublehyphendemerits\z@\finalhyphendemerits\z@
                \strut ##1\strut}%
        }%
        % If the linebreak is at a space, the latter will be displayed as visible
        % space at end of first line, and a continuation symbol starts next line.
        % Stretch/shrink are however usually zero for typewriter font.
        \def\FV@Space {%
            \nobreak\hskip\z@ plus\fontdimen3\font minus\fontdimen4\font
            \discretionary{\copy\Wrappedvisiblespacebox}{\Wrappedafterbreak}
            {\kern\fontdimen2\font}%
        }%
        
        % Allow breaks at special characters using \PYG... macros.
        \Wrappedbreaksatspecials
        % Breaks at punctuation characters . , ; ? ! and / need catcode=\active 	
        \OriginalVerbatim[#1,codes*=\Wrappedbreaksatpunct]%
    }
    \makeatother

    % Exact colors from NB
    \definecolor{incolor}{HTML}{303F9F}
    \definecolor{outcolor}{HTML}{D84315}
    \definecolor{cellborder}{HTML}{CFCFCF}
    \definecolor{cellbackground}{HTML}{F7F7F7}
    
    % prompt
    \makeatletter
    \newcommand{\boxspacing}{\kern\kvtcb@left@rule\kern\kvtcb@boxsep}
    \makeatother
    \newcommand{\prompt}[4]{
        {\ttfamily\llap{{\color{#2}[#3]:\hspace{3pt}#4}}\vspace{-\baselineskip}}
    }
    

    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

\begin{document}
    
    \maketitle
    
    

    
    \hypertarget{parallel-computing}{%
\section{Parallel Computing}\label{parallel-computing}}

Julia supports: * coroutines (aka green threads) * multithreading
(without a Global interpreter lock like CPython) * multiprocessing and
distributed computing.

    \hypertarget{coroutines}{%
\subsection{Coroutines}\label{coroutines}}

Here is coroutine version of a \texttt{fibonacci()} generator function:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{function} \PY{n}{fibonacci}\PY{p}{(}\PY{n}{n}\PY{p}{)}
    \PY{k+kt}{Channel}\PY{p}{(}\PY{p}{)} \PY{k}{do} \PY{n}{ch}
        \PY{n}{a}\PY{p}{,} \PY{n}{b} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}
        \PY{k}{for} \PY{n}{i} \PY{k}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{n}
            \PY{n}{put!}\PY{p}{(}\PY{n}{ch}\PY{p}{,} \PY{n}{a}\PY{p}{)}
            \PY{n}{a}\PY{p}{,} \PY{n}{b} \PY{o}{=} \PY{n}{b}\PY{p}{,} \PY{n}{a} \PY{o}{+} \PY{n}{b}
        \PY{k}{end}
    \PY{k}{end}
\PY{k}{end}

\PY{k}{for} \PY{n}{f} \PY{k}{in} \PY{n}{fibonacci}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
    \PY{n}{println}\PY{p}{(}\PY{n}{f}\PY{p}{)}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    \texttt{Channel()\ do\ ...\ end} creates a \texttt{Channel} object, and
spawns an asynchronous \texttt{Task} to execute the code in the
\texttt{do\ ...\ end} block.

The task is scheduled to execute immediately, but when it calls the
\texttt{put!()} function on the channel to yield a value, it blocks
until another task calls the \texttt{take!()} function to grab the
\texttt{put!()} value.

\texttt{take!()} function is not impleteded explicitly in the code
example, since it is executed automatically in the \texttt{for} loop, in
the main task.

To demonstrate this, we can just call the \texttt{take!()} function 10
times to get all the items from the channel:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ch} \PY{o}{=} \PY{n}{fibonacci}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\PY{k}{for} \PY{n}{i} \PY{k}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{10}
    \PY{n}{println}\PY{p}{(}\PY{n}{take!}\PY{p}{(}\PY{n}{ch}\PY{p}{)}\PY{p}{)}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    This channel is bound to the task, therefore it is automatically closed
when the task ends.

So if we try to get one more element, we will get an exception:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{try}
    \PY{n}{take!}\PY{p}{(}\PY{n}{ch}\PY{p}{)}
\PY{k}{catch} \PY{n}{ex}
    \PY{n}{ex}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    Here is a more explicit version of the \texttt{fibonacci()} function:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{function} \PY{n}{fibonacci}\PY{p}{(}\PY{n}{n}\PY{p}{)}
  \PY{k}{function} \PY{n}{generator\PYZus{}func}\PY{p}{(}\PY{n}{ch}\PY{p}{,} \PY{n}{n}\PY{p}{)}
    \PY{n}{a}\PY{p}{,} \PY{n}{b} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{1}
    \PY{k}{for} \PY{n}{i} \PY{k}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{n}
        \PY{n}{put!}\PY{p}{(}\PY{n}{ch}\PY{p}{,} \PY{n}{a}\PY{p}{)}
        \PY{n}{a}\PY{p}{,} \PY{n}{b} \PY{o}{=} \PY{n}{b}\PY{p}{,} \PY{n}{a} \PY{o}{+} \PY{n}{b}
    \PY{k}{end}
  \PY{k}{end}
  \PY{n}{ch} \PY{o}{=} \PY{k+kt}{Channel}\PY{p}{(}\PY{p}{)}
  \PY{n}{task} \PY{o}{=} \PY{n+nd}{@task} \PY{n}{generator\PYZus{}func}\PY{p}{(}\PY{n}{ch}\PY{p}{,} \PY{n}{n}\PY{p}{)} \PY{c}{\PYZsh{} creates a task without starting it}
  \PY{n}{bind}\PY{p}{(}\PY{n}{ch}\PY{p}{,} \PY{n}{task}\PY{p}{)} \PY{c}{\PYZsh{} the channel will be closed when the task ends}
  \PY{n}{schedule}\PY{p}{(}\PY{n}{task}\PY{p}{)} \PY{c}{\PYZsh{} start running the task asynchronously}
  \PY{n}{ch}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    And here is a more explicit version of the \texttt{for} loop:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ch} \PY{o}{=} \PY{n}{fibonacci}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\PY{k}{while} \PY{n}{isopen}\PY{p}{(}\PY{n}{ch}\PY{p}{)}
  \PY{n}{value} \PY{o}{=} \PY{n}{take!}\PY{p}{(}\PY{n}{ch}\PY{p}{)}
  \PY{n}{println}\PY{p}{(}\PY{n}{value}\PY{p}{)}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    Note that asynchronous tasks (also called ``coroutines'' or ``green
threads'') are not actually run in parallel: they cooperate to alternate
execution.

Some functions, such as \texttt{put!()}, \texttt{take!()}, and many I/O
functions, interrupt the current task's execution, at which point it
lets Julia's scheduler decide which task should resume its execution.

    \hypertarget{multithreading}{%
\subsection{Multithreading}\label{multithreading}}

Julia also supports multithreading.

You need to specify the number of available threads upon startup, by
setting the \texttt{JULIA\_NUM\_THREADS} environment variable (or
setting the \texttt{-t} argument).

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{if} \PY{n}{haskey}\PY{p}{(}\PY{n+nb}{ENV}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{JULIA\PYZus{}NUM\PYZus{}THREADS}\PY{l+s}{\PYZdq{}}\PY{p}{)}
	\PY{n+nd}{@info} \PY{l+s}{\PYZdq{}}\PY{l+s}{Number of threads:}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n+nb}{ENV}\PY{p}{[}\PY{l+s}{\PYZdq{}}\PY{l+s}{JULIA\PYZus{}NUM\PYZus{}THREADS}\PY{l+s}{\PYZdq{}}\PY{p}{]}
\PY{k}{else}
	\PY{n+nd}{@warn} \PY{l+s}{\PYZdq{}}\PY{l+s}{No treads; restart julia as `julia \PYZhy{}t 8`}\PY{l+s}{\PYZdq{}}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    The actual number of threads started by Julia may be lower than that, as
it is limited to the number of available cores on the machine (thanks to
hyperthreading, each physical core may run two threads).

Here is the number of threads that were actually started:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Base}\PY{o}{.}\PY{n}{Threads}\PY{o}{.}\PY{n}{nthreads}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Now let us run 10 tasks across these threads:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@Base}\PY{o}{.}\PY{n}{Threads}\PY{o}{.}\PY{n}{threads} \PY{k}{for} \PY{n}{i} \PY{k}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{10}
    \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{thread \PYZsh{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{Base}\PY{o}{.}\PY{n}{Threads}\PY{o}{.}\PY{n}{threadid}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ is starting task \PYZsh{}}\PY{l+s+si}{\PYZdl{}i}\PY{l+s}{\PYZdq{}}\PY{p}{)}
    \PY{n}{sleep}\PY{p}{(}\PY{n}{rand}\PY{p}{(}\PY{p}{)}\PY{p}{)} \PY{c}{\PYZsh{} pretend we\PYZsq{}re actually working}
    \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{thread \PYZsh{}}\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{Base}\PY{o}{.}\PY{n}{Threads}\PY{o}{.}\PY{n}{threadid}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{l+s}{\PYZdq{}}\PY{l+s}{ is finished}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    Here is a multithreaded version of the \texttt{estimate\_pi()} function.

Each thread computes part of the sum, and the parts are added at the
end:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{import} \PY{n}{BenchmarkTools}

\PY{k}{function} \PY{n}{parallel\PYZus{}estimate\PYZus{}pi}\PY{p}{(}\PY{n}{n}\PY{p}{)}
  \PY{n}{s} \PY{o}{=} \PY{n}{zeros}\PY{p}{(}\PY{n}{Threads}\PY{o}{.}\PY{n}{nthreads}\PY{p}{(}\PY{p}{)}\PY{p}{)}
  \PY{n}{nt} \PY{o}{=} \PY{n}{n} \PY{o}{รท} \PY{n}{Threads}\PY{o}{.}\PY{n}{nthreads}\PY{p}{(}\PY{p}{)}
  \PY{n+nd}{@Threads}\PY{o}{.}\PY{n}{threads} \PY{k}{for} \PY{n}{t} \PY{k}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{Threads}\PY{o}{.}\PY{n}{nthreads}\PY{p}{(}\PY{p}{)}
      \PY{k}{for} \PY{n}{i} \PY{k}{in} \PY{p}{(}\PY{l+m+mi}{1}\PY{o}{:}\PY{n}{nt}\PY{p}{)} \PY{o}{.+} \PY{n}{nt}\PY{o}{*}\PY{p}{(}\PY{n}{t} \PY{o}{\PYZhy{}} \PY{l+m+mi}{1}\PY{p}{)}
        \PY{n+nd}{@inbounds} \PY{n}{s}\PY{p}{[}\PY{n}{t}\PY{p}{]} \PY{o}{+=} \PY{p}{(}\PY{n}{isodd}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{?} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{:} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
      \PY{k}{end}
  \PY{k}{end}
  \PY{k}{return} \PY{l+m+mf}{4.0} \PY{o}{*} \PY{p}{(}\PY{l+m+mf}{1.0} \PY{o}{+} \PY{n}{sum}\PY{p}{(}\PY{n}{s}\PY{p}{)}\PY{p}{)}
\PY{k}{end}

\PY{n+nd}{@BenchmarkTools}\PY{o}{.}\PY{n}{btime} \PY{n}{parallel\PYZus{}estimate\PYZus{}pi}\PY{p}{(}\PY{l+m+mi}{100\PYZus{}000\PYZus{}000}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    The \texttt{@inbounds} macro is an optimization: it tells the Julia
compiler not to add any bounds check when accessing the array.

It is safe in this case since the \texttt{s} array has one element per
thread, and \texttt{t} varies from \texttt{1} to
\texttt{Threads.nthreads()}, so there is no risk for \texttt{s{[}t{]}}
to be out of bounds.

    Let's compare this with the single-threaded implementation:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{function} \PY{n}{estimate\PYZus{}pi}\PY{p}{(}\PY{n}{n}\PY{p}{)}
    \PY{n}{s} \PY{o}{=} \PY{l+m+mf}{1.0}
    \PY{k}{for} \PY{n}{i} \PY{k}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{n}{n}
        \PY{n}{s} \PY{o}{+=} \PY{p}{(}\PY{n}{isodd}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{?} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{:} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}
    \PY{k}{end}
    \PY{k}{return} \PY{l+m+mi}{4}\PY{n}{s}
\PY{k}{end}

\PY{n+nd}{@BenchmarkTools}\PY{o}{.}\PY{n}{btime} \PY{n}{estimate\PYZus{}pi}\PY{p}{(}\PY{l+m+mi}{100\PYZus{}000\PYZus{}000}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Julia has a \texttt{mapreduce()} function which makes it easy to
implement functions like \texttt{parallel\_estimate\_pi()}:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{function} \PY{n}{parallel\PYZus{}estimate\PYZus{}pi2}\PY{p}{(}\PY{n}{n}\PY{p}{)}
    \PY{l+m+mf}{4.0} \PY{o}{*} \PY{n}{mapreduce}\PY{p}{(}\PY{n}{i} \PY{o}{\PYZhy{}\PYZgt{}} \PY{p}{(}\PY{n}{isodd}\PY{p}{(}\PY{n}{i}\PY{p}{)} \PY{o}{?} \PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{:} \PY{l+m+mi}{1}\PY{p}{)} \PY{o}{/} \PY{p}{(}\PY{l+m+mi}{2}\PY{n}{i} \PY{o}{+} \PY{l+m+mi}{1}\PY{p}{)}\PY{p}{,} \PY{o}{+}\PY{p}{,} \PY{l+m+mi}{0}\PY{o}{:}\PY{n}{n}\PY{p}{)}
\PY{k}{end}

\PY{n+nd}{@BenchmarkTools}\PY{o}{.}\PY{n}{btime} \PY{n}{parallel\PYZus{}estimate\PYZus{}pi2}\PY{p}{(}\PY{l+m+mi}{100\PYZus{}000\PYZus{}000}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    The \texttt{mapreduce()} function is well optimized, so it's about twice
faster than \texttt{parallel\_estimate\_pi()}.

    You can also spawn a task using \texttt{Threads.@spawn}. It will get
executed on any one of the running threads (it will not start a new
thread):

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{task} \PY{o}{=} \PY{n}{Threads}\PY{o}{.}\PY{n+nd}{@spawn} \PY{k}{begin}
    \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Thread starting}\PY{l+s}{\PYZdq{}}\PY{p}{)}
    \PY{n}{sleep}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
    \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Thread stopping}\PY{l+s}{\PYZdq{}}\PY{p}{)}
    \PY{k}{return} \PY{l+m+mi}{42}
\PY{k}{end}

\PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Hello!}\PY{l+s}{\PYZdq{}}\PY{p}{)}

\PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{The result is: }\PY{l+s}{\PYZdq{}}\PY{p}{,} \PY{n}{fetch}\PY{p}{(}\PY{n}{task}\PY{p}{)}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    The \texttt{fetch()} function waits for the thread to finish, and
fetches the result. You can also just call \texttt{wait()} if you don't
need the result.

    You can also use channels to synchronize and communicate across tasks,
even if they are running across separate threads:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{ch} \PY{o}{=} \PY{k+kt}{Channel}\PY{p}{(}\PY{p}{)}
\PY{n}{task1} \PY{o}{=} \PY{n}{Threads}\PY{o}{.}\PY{n+nd}{@spawn} \PY{k}{begin}
    \PY{k}{for} \PY{n}{i} \PY{k}{in} \PY{l+m+mi}{1}\PY{o}{:}\PY{l+m+mi}{5}
        \PY{n}{sleep}\PY{p}{(}\PY{n}{rand}\PY{p}{(}\PY{p}{)}\PY{p}{)}
        \PY{n}{put!}\PY{p}{(}\PY{n}{ch}\PY{p}{,} \PY{n}{i}\PY{o}{\PYZca{}}\PY{l+m+mi}{2}\PY{p}{)}
    \PY{k}{end}
    \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Finished sending!}\PY{l+s}{\PYZdq{}}\PY{p}{)}
    \PY{n}{close}\PY{p}{(}\PY{n}{ch}\PY{p}{)}
\PY{k}{end}

\PY{n}{task2} \PY{o}{=} \PY{n}{Threads}\PY{o}{.}\PY{n+nd}{@spawn} \PY{k}{begin}
    \PY{n}{foreach}\PY{p}{(}\PY{n}{v}\PY{o}{\PYZhy{}\PYZgt{}}\PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Received }\PY{l+s+si}{\PYZdl{}v}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{,} \PY{n}{ch}\PY{p}{)}
    \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Finished receiving!}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\PY{k}{end}

\PY{n}{wait}\PY{p}{(}\PY{n}{task2}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    \hypertarget{multiprocessing-distributed-programming}{%
\subsection{Multiprocessing \& Distributed
Programming}\label{multiprocessing-distributed-programming}}

Julia can spawn multiple Julia processes upon startup if you specify the
number of processes via the \texttt{-p} argument.

You can also spawn extra processes from Julia itself:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{import} \PY{n}{Distributed}
\PY{n}{Distributed}\PY{o}{.}\PY{n}{addprocs}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{)}
\PY{n}{Distributed}\PY{o}{.}\PY{n}{workers}\PY{p}{(}\PY{p}{)} \PY{c}{\PYZsh{} array of worker process ids}
\end{Verbatim}
\end{tcolorbox}

    The main process has id 1:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{Distributed}\PY{o}{.}\PY{n}{myid}\PY{p}{(}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    The \texttt{@Distributed.everywhere} macro lets you run any code on all
workers:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{everywhere} \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Hi! I\PYZsq{}m worker }\PY{l+s+si}{\PYZdl{}}\PY{p}{(}\PY{n}{Distributed}\PY{o}{.}\PY{n}{myid}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    You can also execute code on a particular worker by using
\texttt{@Distributed.spawnat\ \textless{}worker\ id\textgreater{}\ \textless{}statement\textgreater{}}:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{3} \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Hi! I\PYZsq{}m worker }\PY{l+s+si}{\PYZdl{}}\PY{p}{(}\PY{n}{Distributed}\PY{o}{.}\PY{n}{myid}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    If you specify \texttt{:any} instead of a worker id, Julia chooses the
worker for you:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{o}{:}\PY{n}{any} \PY{n}{println}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{Hi! I\PYZsq{}m worker }\PY{l+s+si}{\PYZdl{}}\PY{p}{(}\PY{n}{Distributed}\PY{o}{.}\PY{n}{myid}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{l+s}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Both \texttt{@Distributed.everywhere} and \texttt{@Distributed.spawnat}
return immediately.

The output of \texttt{@Distributed.spawnat} is a \texttt{Future} object.

You can call \texttt{fetch()} on this object to wait for the result:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{result} \PY{o}{=} \PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{3} \PY{l+m+mi}{1}\PY{o}{+}\PY{l+m+mi}{2}\PY{o}{+}\PY{l+m+mi}{3}\PY{o}{+}\PY{l+m+mi}{4}
\PY{n}{fetch}\PY{p}{(}\PY{n}{result}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    If you import some package in the main process, it is not automatically
imported in the workers.

For example, the following code fails because the worker does not know
what \texttt{pyimport} is:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{using} \PY{n}{PyCall}

\PY{n}{result} \PY{o}{=} \PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{4} \PY{p}{(}\PY{n}{np} \PY{o}{=} \PY{n}{pyimport}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{numpy}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{;} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}

\PY{k}{try}
    \PY{n}{fetch}\PY{p}{(}\PY{n}{result}\PY{p}{)}
\PY{k}{catch} \PY{n}{ex}
    \PY{n}{ex}
\PY{k}{end}
\end{Verbatim}
\end{tcolorbox}

    You must use \texttt{@Distributed.everywhere} or
\texttt{@Distributed.spawnat} to be able to use \texttt{using} of
packages you need in each worker:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{everywhere} \PY{k}{using} \PY{n}{PyCall}

\PY{n}{result} \PY{o}{=} \PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{4} \PY{p}{(}\PY{n}{np} \PY{o}{=} \PY{n}{pyimport}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{numpy}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{;} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}

\PY{n}{fetch}\PY{p}{(}\PY{n}{result}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Or simple you can use \texttt{import} which imports packages
automatically to all workers.

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{k}{import} \PY{n}{PyCall}

\PY{n}{result} \PY{o}{=} \PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{4} \PY{p}{(}\PY{n}{np} \PY{o}{=} \PY{n}{PyCall}\PY{o}{.}\PY{n}{pyimport}\PY{p}{(}\PY{l+s}{\PYZdq{}}\PY{l+s}{numpy}\PY{l+s}{\PYZdq{}}\PY{p}{)}\PY{p}{;} \PY{n}{np}\PY{o}{.}\PY{n}{log}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}

\PY{n}{fetch}\PY{p}{(}\PY{n}{result}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    Similarly, if you define a function in the main process, it is not
automatically available in the workers. You must define the function in
every worker:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{everywhere} \PY{n}{addtwo}\PY{p}{(}\PY{n}{n}\PY{p}{)} \PY{o}{=} \PY{n}{n} \PY{o}{+} \PY{l+m+mi}{2}

\PY{n}{result} \PY{o}{=} \PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{4} \PY{n}{addtwo}\PY{p}{(}\PY{l+m+mi}{40}\PY{p}{)}

\PY{n}{fetch}\PY{p}{(}\PY{n}{result}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    You can pass a \texttt{Future} to \texttt{@Distributed.everywhere} or
\texttt{@Distributed.spawnat}, as long as you wrap it in a
\texttt{fetch()} function:

    \begin{tcolorbox}[breakable, size=fbox, boxrule=1pt, pad at break*=1mm,colback=cellbackground, colframe=cellborder]
\prompt{In}{incolor}{ }{\boxspacing}
\begin{Verbatim}[commandchars=\\\{\}]
\PY{n}{M} \PY{o}{=} \PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{2} \PY{n}{rand}\PY{p}{(}\PY{l+m+mi}{5}\PY{p}{)}

\PY{n}{result} \PY{o}{=} \PY{n+nd}{@Distributed}\PY{o}{.}\PY{n}{spawnat} \PY{l+m+mi}{3} \PY{n}{fetch}\PY{p}{(}\PY{n}{M}\PY{p}{)} \PY{o}{.*} \PY{l+m+mf}{10.0}

\PY{n}{fetch}\PY{p}{(}\PY{n}{result}\PY{p}{)}
\end{Verbatim}
\end{tcolorbox}

    In this example, worker 2 creates a random array, then worker 3 fetches
this array and multiplies each element by 10, then the main process
fetches the result and displays it.


    % Add a bibliography block to the postdoc
    
    
    
\end{document}
